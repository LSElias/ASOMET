<div class="flex">
  <app-menu></app-menu>
  <div class="w-full">
    <app-header></app-header>
    <div class="bg-gray-100 w-full h-full py-1">
      <div class="flex bg-white mx-5 my-5 h-36 rounded-lg drop-shadow-md">
        <div class="ml-5 my-6 border-left"></div>
        <div class="my-5 ml-5 mx-2 py-4 px-2 w-36 bg-blue-100 rounded-lg text-center flex flex-col">
          <img class="self-center pb-1" src="../../../assets/images/adminUserIcon.png" />
          <h5 class="text-base tracking-tight text-[#464846]">
            Administrativos
          </h5>
          <p class="font-normal text-gray-700 dark:text-gray-400">
            {{admins.length}}

          </p>
        </div>

        <div class="my-5 mx-2 py-4 px-2 w-36 bg-orange-100 rounded-lg text-center flex flex-col">
          <img class="self-center pb-1" src="../../../assets/images/opUserIcon.png" />
          <h5 class="text-base tracking-tight text-[#464846]">Operarios</h5>
          <p class="font-normal text-gray-700 dark:text-gray-400">
            {{ops.length}}

          </p>
        </div>

        <div class="my-5 mx-2 py-4 px-2 w-36 bg-yellow-50 rounded-lg text-center flex flex-col">
          <img class="self-center pb-1" src="../../../assets/images/asocUserIcon.png" />
          <h5 class="text-base tracking-tight text-[#464846]">Asociados</h5>
          <p class="font-normal text-gray-700 dark:text-gray-400">
            {{asociados.length}}
          </p>
        </div>
      </div>

      <div class="bg-white mx-5 my-5 h-fit rounded-lg p-2 justify-center gap-2 drop-shadow-sm">
        <div class="flex w-full h-fit p-3">

          <!-- ========== Crear Usuario  ========== -->
          <div>

            <button type="button" (click)="crear()"
              class="py-2.5 px-3 me-2 mb-2 text-sm h-fit flex gap-1 font-medium text-white rounded-lg bg-[#8197B1] hover:bg-[#6E749B] transition duration-200">
              <ng-icon name="heroPlus" size="1.4em"></ng-icon>
              <p>Nuevo Usuario</p>
            </button>

          </div>
          <!-- ========== Crear Usuario ========== -->

          <span class="example-spacer"></span>

          <!-- ========== Dropdown Estado  ========== -->


          <form class="max-w-sm mx-auto">
            <select id="estados" (change)="statusChange($event.target)"
              class="text-[#1B78B7] h-fit font-semibold rounded-lg text-sm px-5 py-2.5 inline-flex items-center border-gray-300">
              <option *ngFor="let status of statuses" [value]="status.id">
                {{status.name}}
              </option>
            </select>
          </form>


          <!-- ========== Dropdown Estado  ========== -->

          <!-- ========== Dropdown Rol  ========== -->
          <form class="max-w-sm mx-5">
            <select id="estados" (change)="roleChange($event.target)"
              class="text-[#5A6ACF] h-fit font-semibold rounded-lg text-sm px-5 py-2.5 inline-flex items-center border-gray-300">
              <option *ngFor="let rol of roles" [value]="rol.id">
                {{rol.name}}
              </option>
            </select>
          </form>
          <!-- ========== Dropdown Rol  ========== -->

          <!-- ========== Search Cédula  ========== -->
          <div class="max-w-md mx-auto">
            <div class="relative">
              <div class="absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none">
                <svg class="w-4 h-4 text-indigo-600" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none"
                  viewBox="0 0 20 20">
                  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z" />
                </svg>
              </div>
              <input (change)="cedulaChange($event.target)" type="search" id="default-search"
                class="block w-full h-11 p-4 ps-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-transparent focus:ring-indigo-600 focus:border-indigo-600"
                placeholder="Buscar por cédula" required />
            </div>
          </div>
        </div>
        <!-- ========== Search Cédula  ========== -->


        <!-- ========== Table Usuarios  ========== -->
        <div class="relative overflow-x-auto p-3">
          <table mat-table [dataSource]="dataSource" matSort class="w-full text-sm text-left rtl:text-right ">
            <ng-container matColumnDef="id">
              <th scope="col" class=" border text-xs text-black border-white colcolor rounded-tl-md" mat-header-cell
                *matHeaderCellDef mat-sort-header>
                Id
              </th>
              <td scope="row" class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap" mat-cell
                *matCellDef="let row">
                {{ row.id }}
              </td>
            </ng-container>

            <ng-container matColumnDef="cedula">
              <th scope="col" class=" border text-xs text-black border-white colcolor" mat-header-cell *matHeaderCellDef
                mat-sort-header>
                Cédula
              </th>
              <td scope="row" class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap" mat-cell
                *matCellDef="let row">
                {{ row.cedula }}
              </td>
            </ng-container>

            <ng-container matColumnDef="nombre">
              <th scope="col" class=" border text-xs text-black border-white colcolor" mat-header-cell *matHeaderCellDef
                mat-sort-header>
                Nombre
              </th>
              <td scope="row" class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap" mat-cell
                *matCellDef="let row">
                {{ row.nombreCompleto }}
              </td>
            </ng-container>

            <ng-container matColumnDef="correo">
              <th scope="col" class="border text-xs text-black border-white colcolor" mat-header-cell *matHeaderCellDef
                mat-sort-header>
                Correo
              </th>
              <td scope="row" class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap" mat-cell
                *matCellDef="let row">
                {{ row.correo }}
              </td>
            </ng-container>

            <ng-container matColumnDef="accion">
              <th scope="col" class="border text-xs text-center text-black border-white colcolor" mat-header-cell
                *matHeaderCellDef mat-sort-header style="margin: 0 auto;">
                Acciones
              </th>


              <td mat-cell *matCellDef="let row">
                <div class="flex  gap-5">
                  <button mat-mini-fab class="bt-detalle h-5 w-5" matTooltip="Ir a Detalle" aria-label="Ir a Detalle"
                    (click)="redirectDetalle(row.id)"></button>
                  <button *ngIf="!(this.usuariologged._rol.idRol === 2 && (row.idRol === 2 || row.idRol === 1))"
                    mat-mini-fab class="bt-editar h-5 w-5" matTooltip="Editar" aria-label="Editar"
                    (click)="update(row.id)"></button>
                  <button mat-mini-fab class="bt-desactivar h-5 w-5" matTooltip="Desactivar" aria-label="Desactivar"
                    (click)="deactivate(row.id)"></button>
                </div>
              </td>
            </ng-container>


            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
          </table>
          <div>
            <mat-paginator #paginator [lang]="'es'" [length]="dataSource.data.length" [pageIndex]="0" [pageSize]="5"
              aria-label="Seleccione una página">
            </mat-paginator>
          </div>

        </div>
        <!-- ========== Table Usuarios  ========== -->


      </div>
    </div>
  </div>
</div>

<!-- Modal de Crear Usuario -->
<app-usuario-create #userFormModal></app-usuario-create>
<app-usuario-asistencia #userInvited></app-usuario-asistencia>
<app-usuario-desactivar #hideUserFormModal></app-usuario-desactivar>
<app-usuario-detalle #userDetalleModal></app-usuario-detalle>